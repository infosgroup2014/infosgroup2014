<div class="row">
  <div class="col-xs-12 col-md-12">
    <button type="button" class="btn btn-outline-primary" (click)="regresar()">
      <i class="fa fa-arrow-left" aria-hidden="true"></i>&nbsp;Regresar
    </button>
  </div>

  <div class="col-xs-12 col-md-12 my-2">
    <div class="card shadow-lg bg-light p-3 mb-5">
      <h5 class="card-header fondoAzul">{{ planillaService.leyenda }}</h5>
      <div class="card-body">
        <div class="alert alert-primary">
          <span>
            <i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp;Campos
            Marcados <span style="color: red">*</span>
            Son Requeridos.
          </span>
        </div>
        <form [formGroup]="formAccionNoAfecta">
          <div class="row">
            <div class="form-group col-xs-4 col-md-4">
              <label for="email">Fecha Solicitud:</label>

              <div class="input-group">
                <input
                  class="form-control"
                  [(ngModel)]="fechaSolicitud"
                  ngbDatepicker
                  #d2="ngbDatepicker"
                  [ngModelOptions]="{ standalone: true }"
                />
                <div class="input-group-append">
                  <button
                    class="btn btn-outline-secondary fa fa-calendar"
                    (click)="d2.toggle()"
                    type="button"
                  ></button>
                </div>
              </div>
            </div>

            <div class="form-group col-xs-6 col-md-6">
              <label for="email"
                >Empleado:&nbsp;<span style="color: blue"
                  >{{ empleado?.empleadosPK?.codEmp }}
                  {{ empleado?.nombres }}
                  {{ empleado?.apellidos }}</span
                >
              </label>
              <div class="input-group-append">
                <button
                  type="button"
                  class="btn btn-primary"
                  data-toggle="modal"
                  data-target="#exampleModal"
                  data-whatever="@mdo"
                >
                  Seleccionar Empleado
                </button>
              </div>
            </div>

            <div class="form-group col-xs-4 col-md-4">
              <label for="email">Jefe </label>
              <div class="input-group-append">
                <label style="color: blue">{{ depenciaEmpleado?.jefe }}</label>
              </div>
            </div>

            <div class="form-group col-xs-6 col-md-6">
              <label for="email">Departamento:&nbsp;</label>
              <div class="input-group-append">
                <label style="color: blue">{{
                  depenciaEmpleado?.departamento?.nomDepto
                }}</label>
              </div>
            </div>

            <div class="form-group col-xs-4 col-md-4">
              <label for="email">Puesto:&nbsp;</label>
              <div class="input-group-append">
                <label style="color: blue">{{
                  depenciaEmpleado?.puesto?.nomPuesto
                }}</label>
              </div>
            </div>

            <div class="form-group col-xs-8 col-md-8">
              <label for="email">Detalle Accion:&nbsp;</label>
              <div class="input-group-append">
                <textarea
                  formControlName="detalle"
                  style="overflow: hidden; resize: none"
                  class="form-control"
                ></textarea>
              </div>
            </div>

            <div class="form-group col-xs-4 col-md-4">
              <label for="email">Observacion:&nbsp;</label>
              <div class="input-group-append">
                <textarea
                  formControlName="observacion"
                  style="overflow: hidden; resize: none"
                  class="form-control"
                ></textarea>
              </div>
            </div>

            <div
              *ngIf="
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion === 0
              "
              class="form-group col-xs-4 col-md-4"
            >
              <label for="email">Tipo de Accion:&nbsp;</label>
              <ng-select
                formControlName="tipoAccion"
                style="width: auto"
                (change)="asignarTipoAccion($event)"
              >
                <ng-option
                  *ngFor="let tipo of listaNoAfectaPlanilla"
                  [value]="tipo.tipoAccionPK.codTipoaccion"
                >
                  {{ tipo.nomTipoaccion }}</ng-option
                >
              </ng-select>
            </div>

            <div
              *ngIf="
                listaCausasRenuncia &&
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 3 &&
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 2
              "
              class="form-group col-xs-4 col-md-4"
            >
              <label for="email">Motivo: &nbsp;</label>
              <ng-select formControlName="motivo" style="width: auto">
                <ng-option
                  *ngFor="let mov2 of listaCausasRenuncia"
                  [value]="mov2.causasRenunciaPK.codTiporenuncia"
                >
                  {{ mov2.descripcion }}
                </ng-option>
              </ng-select>
            </div>

            <div *ngIf="false" class="form-group col-xs-4 col-md-4">
              <label for="email">Motivo :&nbsp;</label>
              <ng-select formControlName="motivo" style="width: auto">
                <ng-option
                  *ngFor="let mov of listaMotivos"
                  [value]="mov.motivosPk.codMotivo"
                >
                  {{ mov.motivo }}
                </ng-option>
              </ng-select>
            </div>

            <div
              *ngIf="
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 0 &&
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 5 &&
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 12
              "
              class="form-group col-xs-4 col-md-4"
            >
              <label for="disponibles">Dias Disponible Actual:</label>
              <div class="input-group">
                <input
                  type="text"
                  disabled
                  class="form-control"
                  formControlName="diaDispoInicial"
                />
              </div>
            </div>

            <div
              *ngIf="
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 0 &&
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 5 &&
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 12
              "
              class="form-group col-xs-4 col-md-4"
            >
              <label for="disponibles">Dias Disponible Final:</label>
              <div class="input-group">
                <input
                  type="text"
                  disabled
                  class="form-control"
                  formControlName="diasDispoFinal"
                />
              </div>
            </div>

            <div class="form-group col-xs-4 col-md-4">
              <label for="email">Fecha Inicial:</label>

              <div class="input-group">
                <input
                  class="form-control"
                  name="dp3"
                  [(ngModel)]="fechaInicial"
                  ngbDatepicker
                  #d3="ngbDatepicker"
                  [ngModelOptions]="{ standalone: true }"
                />

                <div class="input-group-append">
                  <button
                    class="btn btn-outline-secondary fa fa-calendar"
                    (click)="d3.toggle()"
                    type="button"
                  ></button>
                </div>
              </div>
            </div>

            <div class="form-group col-xs-4 col-md-4">
              <label for="email">Fecha Final:</label>

              <div class="input-group">
                <input
                  (ngModelChange)="changeCalculoDias($event)"
                  class="form-control"
                  [(ngModel)]="fechaFinal"
                  ngbDatepicker
                  #d4="ngbDatepicker"
                  [ngModelOptions]="{ standalone: true }"
                />
                <div class="input-group-append">
                  <button
                    class="btn btn-outline-secondary fa fa-calendar"
                    (click)="d4.toggle()"
                    type="button"
                  ></button>
                </div>
              </div>
            </div>

            <div
              class="form-group col-xs-2 col-md-2"
            >
              <label for="dias">Dias:</label>
              <input
                type="text"
                name="dias"
                id="dias"
                (keypress)="validarNumero($event)"
                formControlName="dias"
                class="form-control"
              />
            </div>

            <div class="form-group col-xs-6 col-md-6">
              <label
                >Horas: &nbsp;<span style="color: blue">{{
                  horas
                }}</span></label
              >

              <div class="btn-group" role="group" aria-label="Basic example">
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarHora(1)"
                >
                  1
                </button>
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarHora(2)"
                >
                  2
                </button>
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarHora(3)"
                >
                  3
                </button>
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarHora(4)"
                >
                  4
                </button>
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarHora(5)"
                >
                  5
                </button>
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarHora(6)"
                >
                  6
                </button>
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarHora(7)"
                >
                  7
                </button>
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarHora(8)"
                >
                  8
                </button>
              </div>
            </div>

            <div class="form-group col-xs-4 col-md-4">
              <label
                >Minutos: &nbsp;<span style="color: blue">{{
                  minutos
                }}</span></label
              >

              <div class="btn-group" role="group" aria-label="Basic example">
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarMinutos(30)"
                >
                  30
                </button>
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarMinutos(40)"
                >
                  40
                </button>
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarMinutos(50)"
                >
                  50
                </button>
                <button
                  type="button"
                  class="btn btn-info"
                  (click)="asignarMinutos(60)"
                >
                  60
                </button>
              </div>
            </div>

            <div
              class="form-group col-xs-2 col-md-2"
              *ngIf="
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 0 &&
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 2 &&
                planillaService?.tipoAccionSeleccion?.tipoAccionPK
                  ?.codTipoaccion != 3
              "
            >
              <label for="formFileSm" class="form-label"
                >Descontar Septimo</label
              >
              <div class="input-group-append">
                <select
                  id="company"
                  class="form-control"
                  formControlName="descontar"
                >
                  <option value="N">No</option>
                  <option value="S">Si</option>
                </select>
              </div>
            </div>

            <div class="form-group col-xs-6 col-md-6">
              <label for="formFileSm" class="form-label">Adjuntar</label>
              <div class="input-group-append">
                <input
                  class="form-control"
                  (change)="handleUpload($event)"
                  id="formFileSm"
                  type="file"
                />
              </div>
            </div>

            <div class="form-group col-xs-6 col-md-6 pb-4">&nbsp;</div>

            <div class="form-group col-xs-12 col-md-12 mb-4">
              <button
                [disabled]="!formAccionNoAfecta.valid"
                class="btn btn-primary"
                (click)="guardarNoAfectaPlanilla()"
              >
                <i class="fa fa-floppy-o" aria-hidden="true"></i> &nbsp;Guardar
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!---modal de empleados-->

<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  role="dialog"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Empleados</h4>
        <button type="button" class="close" data-dismiss="modal">
          <i class="fa fa-times-circle" aria-hidden="true"></i>
        </button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div class="container">
          <form class="form-emp" [formGroup]="formEmpleado">
            <div class="form-group">
              <label for="empName" class="col-sm-2 col-form-label"
                >Cod Emp &nbsp;</label
              >
              <div class="col-sm-10">
                <input
                  type="text"
                  formControlName="codEmp"
                  name="codEmp"
                  class="form-control"
                  id="codEmp"
                />
              </div>
            </div>
            <div class="form-group">
              <label for="empDesgn" class="col-sm-2 col-form-label"
                >Nombre &nbsp;</label
              >
              <div class="col-sm-10">
                <input
                  type="text"
                  formControlName="nombre"
                  name="nombre"
                  class="form-control"
                  id="nombre"
                />
              </div>
            </div>

            <div class="form-group">
              <label for="empDesgn" class="col-sm-2 col-form-label"
                >Dui &nbsp;</label
              >
              <div class="col-sm-10">
                <input
                  type="text"
                  formControlName="numDui"
                  name="numDui"
                  class="form-control"
                  id="numDui"
                />
              </div>
            </div>

            <div class="form-group">
              <button class="btn btn-primary float-left" (click)="Buscar()">
                <i class="fa fa-eye" aria-hidden="true"></i> &nbsp; Buscar
              </button>

              <button class="btn btn-info float-right" (click)="limpiar()">
                <i class="fa fa-times" aria-hidden="true"></i>&nbsp;Restablecer
              </button>
            </div>
          </form>
        </div>

        <div class="table-responsive">
          <table class="table table-bordered my-4">
            <thead>
              <tr>
                <th scope="col">Codigo</th>
                <th scope="col">Empleado</th>
              </tr>
            </thead>
            <tbody>
              <tr
                *ngFor="
                  let item of listadoEmpleado
                    | paginate
                      : { id: 'pagination1', itemsPerPage: 5, currentPage: p }
                "
                data-dismiss="modal"
                data-target="#empleadoModal"
                (click)="
                  obtenerEmpleado(
                    item.empleadosPK.codCia,
                    item.empleadosPK.codEmp
                  )
                "
              >
                <td>{{ item.empleadosPK.codEmp }}</td>
                <td>{{ item.nombres }} {{ item.apellidos }}</td>
              </tr>
            </tbody>
          </table>
          <pagination-controls
            id="pagination1"
            (pageChange)="p = $event"
          ></pagination-controls>
        </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">
          Cerrar
        </button>
      </div>
    </div>
  </div>
</div>

<!--fin de empleados-->
